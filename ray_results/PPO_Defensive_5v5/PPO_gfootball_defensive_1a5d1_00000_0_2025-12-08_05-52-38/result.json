{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30697768287112315, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000002, "total_loss": 0.02264839614673595, "policy_loss": -0.003891264941776171, "vf_loss": 0.040405149174233275, "vf_explained_var": 0.08083536267280579, "kl": 0.004180991931846923, "entropy": 2.940337424278259, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631], "episode_lengths": [3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6666538030676352, "mean_inference_ms": 0.7221807214326484, "mean_action_processing_ms": 0.24834253644383095, "mean_env_wait_ms": 3.2371024255959937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374980926513672, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.10802745819091797}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "hist_stats": {"episode_reward": [19.98999999998631], "episode_lengths": [3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6666538030676352, "mean_inference_ms": 0.7221807214326484, "mean_action_processing_ms": 0.24834253644383095, "mean_env_wait_ms": 3.2371024255959937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374980926513672, "StateBufferConnector_ms": 0.002968311309814453, "ViewRequirementAgentConnector_ms": 0.10802745819091797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.25952246765522, "num_env_steps_trained_throughput_per_sec": 151.25952246765522, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 26444.587, "sample_time_ms": 19556.695, "learn_time_ms": 6887.722, "learn_throughput": 580.744, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 1, "training_iteration": 1, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-53-06", "timestamp": 1765173186, "time_this_iter_s": 26.44478678703308, "time_total_s": 26.44478678703308, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82e1b820>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 26.44478678703308, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.431578947368422, "ram_util_percent": 32.89473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2947341655815641, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.020961900402229124, "policy_loss": -0.006957903768246372, "vf_loss": 0.04152127382694744, "vf_explained_var": 0.2868021046121915, "kl": 0.010134300392501246, "entropy": 2.9229800236225127, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6669919299698994, "mean_inference_ms": 0.7217801395633576, "mean_action_processing_ms": 0.247984455995479, "mean_env_wait_ms": 3.24008615010602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438690185546875, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.10825395584106445}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6669919299698994, "mean_inference_ms": 0.7217801395633576, "mean_action_processing_ms": 0.247984455995479, "mean_env_wait_ms": 3.24008615010602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438690185546875, "StateBufferConnector_ms": 0.0030279159545898438, "ViewRequirementAgentConnector_ms": 0.10825395584106445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.03187733528358, "num_env_steps_trained_throughput_per_sec": 151.03187733528358, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 26464.525, "sample_time_ms": 19569.508, "learn_time_ms": 6894.866, "learn_throughput": 580.142, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 2, "training_iteration": 2, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-53-33", "timestamp": 1765173213, "time_this_iter_s": 26.48463797569275, "time_total_s": 52.92942476272583, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82e1bee0>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 52.92942476272583, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 10.773684210526316, "ram_util_percent": 34.49473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3518001557762424, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.020416599126668492, "policy_loss": -0.0055108441276631006, "vf_loss": 0.03931942717734879, "vf_explained_var": 0.34364404370387397, "kl": 0.01113440193662882, "entropy": 2.901084856589635, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6681819726033322, "mean_inference_ms": 0.7218441609865106, "mean_action_processing_ms": 0.24793551491960822, "mean_env_wait_ms": 3.2425691488316883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004394849141438802, "StateBufferConnector_ms": 0.003039836883544922, "ViewRequirementAgentConnector_ms": 0.1085042953491211}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6681819726033322, "mean_inference_ms": 0.7218441609865106, "mean_action_processing_ms": 0.24793551491960822, "mean_env_wait_ms": 3.2425691488316883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004394849141438802, "StateBufferConnector_ms": 0.003039836883544922, "ViewRequirementAgentConnector_ms": 0.1085042953491211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.09035587900254, "num_env_steps_trained_throughput_per_sec": 150.09035587900254, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 26526.551, "sample_time_ms": 19601.083, "learn_time_ms": 6925.317, "learn_throughput": 577.591, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 3, "training_iteration": 3, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-53-59", "timestamp": 1765173239, "time_this_iter_s": 26.650784969329834, "time_total_s": 79.58020973205566, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82d8a160>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 79.58020973205566, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 10.755263157894738, "ram_util_percent": 34.66842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3518653113891681, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.027882244232071873, "policy_loss": -0.005054659401454652, "vf_loss": 0.046732009340000026, "vf_explained_var": 0.3385369222362836, "kl": 0.006975224521646245, "entropy": 2.898525694211324, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002193, "opponent_policy": 1.9990000000002193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6702184067854441, "mean_inference_ms": 0.7232893148414401, "mean_action_processing_ms": 0.24814688559747206, "mean_env_wait_ms": 3.2396619510217883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004527568817138672, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.1104736328125}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 2, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002193, "opponent_policy": 1.9990000000002193}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6702184067854441, "mean_inference_ms": 0.7232893148414401, "mean_action_processing_ms": 0.24814688559747206, "mean_env_wait_ms": 3.2396619510217883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004527568817138672, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.1104736328125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.20815921970905, "num_env_steps_trained_throughput_per_sec": 150.20815921970905, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 26552.338, "sample_time_ms": 19577.867, "learn_time_ms": 6974.212, "learn_throughput": 573.542, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 5, "training_iteration": 4, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-54-26", "timestamp": 1765173266, "time_this_iter_s": 26.62992286682129, "time_total_s": 106.21013259887695, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82da2820>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 106.21013259887695, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 10.67027027027027, "ram_util_percent": 34.6108108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3667920043816169, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.01629854664002778, "policy_loss": -0.008412455821332212, "vf_loss": 0.03828396023677973, "vf_explained_var": 0.4408997658888499, "kl": 0.008363840523413728, "entropy": 2.881868473291397, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002197, "opponent_policy": 1.9990000000002197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6719211707396887, "mean_inference_ms": 0.7258586551444509, "mean_action_processing_ms": 0.2485654635182397, "mean_env_wait_ms": 3.242007388333294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004283587137858073, "StateBufferConnector_ms": 0.0030835469563802085, "ViewRequirementAgentConnector_ms": 0.11015733083089192}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002197, "opponent_policy": 1.9990000000002197}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6719211707396887, "mean_inference_ms": 0.7258586551444509, "mean_action_processing_ms": 0.2485654635182397, "mean_env_wait_ms": 3.242007388333294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004283587137858073, "StateBufferConnector_ms": 0.0030835469563802085, "ViewRequirementAgentConnector_ms": 0.11015733083089192}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.1257359000619, "num_env_steps_trained_throughput_per_sec": 145.1257359000619, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 26754.329, "sample_time_ms": 19742.702, "learn_time_ms": 7011.39, "learn_throughput": 570.5, "synch_weights_time_ms": 0.003}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 6, "training_iteration": 5, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-54-54", "timestamp": 1765173294, "time_this_iter_s": 27.562500476837158, "time_total_s": 133.7726330757141, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82d70790>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 133.7726330757141, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.817499999999999, "ram_util_percent": 34.2075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.38054094947874545, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.019634159367124083, "policy_loss": -0.00509906333948796, "vf_loss": 0.038190928619199746, "vf_explained_var": 0.5154689522584279, "kl": 0.009816697110350296, "entropy": 2.887875192960103, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002193, "opponent_policy": 1.9990000000002193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6735540642758177, "mean_inference_ms": 0.7280850028765934, "mean_action_processing_ms": 0.24893748546690125, "mean_env_wait_ms": 3.2455061780645975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004104205540248326, "StateBufferConnector_ms": 0.0030994415283203125, "ViewRequirementAgentConnector_ms": 0.11063473565237862}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002193, "opponent_policy": 1.9990000000002193}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6735540642758177, "mean_inference_ms": 0.7280850028765934, "mean_action_processing_ms": 0.24893748546690125, "mean_env_wait_ms": 3.2455061780645975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004104205540248326, "StateBufferConnector_ms": 0.0030994415283203125, "ViewRequirementAgentConnector_ms": 0.11063473565237862}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.36404574815128, "num_env_steps_trained_throughput_per_sec": 146.36404574815128, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 26850.122, "sample_time_ms": 19818.078, "learn_time_ms": 7031.798, "learn_throughput": 568.845, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 7, "training_iteration": 6, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-55-21", "timestamp": 1765173321, "time_this_iter_s": 27.32941699028015, "time_total_s": 161.10205006599426, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82d8a040>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 161.10205006599426, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.752631578947371, "ram_util_percent": 34.902631578947364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3556997732818127, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.04200606810976751, "policy_loss": -0.005493227893214984, "vf_loss": 0.0608853509684559, "vf_explained_var": 0.2753422270218531, "kl": 0.010423657391196078, "entropy": 2.8856842080752054, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002195, "opponent_policy": 1.9990000000002195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6753918156016714, "mean_inference_ms": 0.7306174015307353, "mean_action_processing_ms": 0.24942144679329475, "mean_env_wait_ms": 3.2477805024343134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003955099317762587, "StateBufferConnector_ms": 0.00318553712632921, "ViewRequirementAgentConnector_ms": 0.1120130221048991}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 2, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002195, "opponent_policy": 1.9990000000002195}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6753918156016714, "mean_inference_ms": 0.7306174015307353, "mean_action_processing_ms": 0.24942144679329475, "mean_env_wait_ms": 3.2477805024343134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003955099317762587, "StateBufferConnector_ms": 0.00318553712632921, "ViewRequirementAgentConnector_ms": 0.1120130221048991}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.4150045021851, "num_env_steps_trained_throughput_per_sec": 151.4150045021851, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 26788.312, "sample_time_ms": 19759.986, "learn_time_ms": 7028.094, "learn_throughput": 569.144, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 9, "training_iteration": 7, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-55-47", "timestamp": 1765173347, "time_this_iter_s": 26.41768217086792, "time_total_s": 187.51973223686218, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82e1b5e0>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 187.51973223686218, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 10.73157894736842, "ram_util_percent": 34.952631578947354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4357038150479396, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.016418292872064436, "policy_loss": -0.01035213931890515, "vf_loss": 0.04004334800915482, "vf_explained_var": 0.4148054334521294, "kl": 0.010838701098070185, "entropy": 2.8713572482268015, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002193, "opponent_policy": 1.9990000000002193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6761979210298923, "mean_inference_ms": 0.7313869128594823, "mean_action_processing_ms": 0.24956957009844966, "mean_env_wait_ms": 3.2483757947145167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038814544677734375, "StateBufferConnector_ms": 0.0031697750091552734, "ViewRequirementAgentConnector_ms": 0.1115560531616211}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002193, "opponent_policy": 1.9990000000002193}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6761979210298923, "mean_inference_ms": 0.7313869128594823, "mean_action_processing_ms": 0.24956957009844966, "mean_env_wait_ms": 3.2483757947145167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038814544677734375, "StateBufferConnector_ms": 0.0031697750091552734, "ViewRequirementAgentConnector_ms": 0.1115560531616211}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.27148928154634, "num_env_steps_trained_throughput_per_sec": 148.27148928154634, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 26811.964, "sample_time_ms": 19752.762, "learn_time_ms": 7058.98, "learn_throughput": 566.654, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 10, "training_iteration": 8, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-56-14", "timestamp": 1765173374, "time_this_iter_s": 26.977836847305298, "time_total_s": 214.49756908416748, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82da3d30>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 214.49756908416748, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 10.760526315789473, "ram_util_percent": 35.33421052631581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"defensive_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42985144327084224, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000002, "total_loss": 0.019039686576773723, "policy_loss": -0.008547937392334764, "vf_loss": 0.04088252572459169, "vf_explained_var": 0.3613247984647751, "kl": 0.009691601144771387, "entropy": 2.8528124741713206, "entropy_coeff": 0.005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 500.0, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 299.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002195, "opponent_policy": 1.9990000000002195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6771647691731499, "mean_inference_ms": 0.7325565970728657, "mean_action_processing_ms": 0.24975077641140972, "mean_env_wait_ms": 3.249199376241899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003939325159246271, "StateBufferConnector_ms": 0.003159046173095703, "ViewRequirementAgentConnector_ms": 0.11156580664894798}}, "episode_reward_max": 19.98999999998631, "episode_reward_min": 19.98999999998631, "episode_reward_mean": 19.98999999998631, "episode_len_mean": 3001.0, "episodes_this_iter": 1, "policy_reward_min": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_max": {"defensive_policy": 1.999000000000219, "opponent_policy": 1.999000000000219}, "policy_reward_mean": {"defensive_policy": 1.9990000000002195, "opponent_policy": 1.9990000000002195}, "hist_stats": {"episode_reward": [19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631, 19.98999999998631], "episode_lengths": [3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001, 3001], "policy_defensive_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219], "policy_opponent_policy_reward": [1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219, 1.999000000000219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6771647691731499, "mean_inference_ms": 0.7325565970728657, "mean_action_processing_ms": 0.24975077641140972, "mean_env_wait_ms": 3.249199376241899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003939325159246271, "StateBufferConnector_ms": 0.003159046173095703, "ViewRequirementAgentConnector_ms": 0.11156580664894798}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.87576653988802, "num_env_steps_trained_throughput_per_sec": 139.87576653988802, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 27010.278, "sample_time_ms": 19807.297, "learn_time_ms": 7202.765, "learn_throughput": 555.342, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 11, "training_iteration": 9, "trial_id": "1a5d1_00000", "date": "2025-12-08_05-56-43", "timestamp": 1765173403, "time_this_iter_s": 28.5970778465271, "time_total_s": 243.09464693069458, "pid": 1853, "hostname": "a1f4a37e7a91", "node_ip": "172.17.0.2", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "gfootball_defensive", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": false, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0xffff82d73e50>", "policies_to_train": ["defensive_policy"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 512, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": true, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"defensive_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.995}], "opponent_policy": [null, "Box(-inf, inf, (115,), float32)", "Discrete(19)", {"gamma": 0.99}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 0}, "time_since_restore": 243.09464693069458, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.773170731707317, "ram_util_percent": 35.324390243902435}}
